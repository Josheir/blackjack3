<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Blacjack</title>
    <link rel="icon" type="image/png" href="favicon.png">
    <link rel="stylesheet" href="style.css">
</head>
<body onunload = "deleteArray()">
    <!-- Script -->
    <script src="script.js"></script>
    

<div id="title">BLACKJACK</div>
<div id="container">
   
        
        
    <canvas id="canvasDealer" width="1000" height="78" ></canvas>
    <div>&nbsp</div>
    <div>&nbsp</div>
    
    <div>
        <canvas id="canvasPlayerRow1" width="1000" height="78"></canvas> 
    
        <div id = "interfaceRow2">
            
            <div id = "messageUpper"><b>-</div>
            <div id = "scoreUpper"><b>-</div>
            
                <input id = "drawCardBtnUpper" type="button" value="Draw Card" >
                <input id = "dealCardBtn" type="button" value="Deal" >
                <input id = "newRoundBtn" type="button" value="New Round" >
                <input id = "wagerButtonOne" type="button" value="Wager 1" onclick="wager(1)" >
                
                <input id = "wagerButtonFive" type="button" value="Wager 5" onclick="wager(5)" >
                
                <input id = "wagerButtonFifteen" type="button" value="Wager 15" onclick="wager(15)" >
             
                <input id = "wagerButtonTwentyfive" type="button" value="Wager 25" onclick="wager(25)" >

            
        </div>
    </div>
    <canvas id="canvasPlayer2" width="1000" height="102" ></canvas>

    <div>
        <div id = "messageLower" ><b>-</div>
    </div>
        
    <div>
        <input id = "drawCardBtnLower" type="button" value="Draw Card" onclick = "drawPlayerCards2(0)"  >

        
       
        
    </div>

    <input id = "split" type="button" value="Split" >
        
       
        
    </div>

    


<script>





document.getElementById('canvasPlayer2').style.visibility = 'hidden';
document.getElementById('messageLower').style.visibility = 'hidden';
document.getElementById('drawCardBtnLower').style.visibility = 'hidden';
document.getElementById('split').style.visibility = 'hidden';


var canvasDealer = document.getElementById("canvasDealer");
let canvasPlayerRow1 = document.getElementById("canvasPlayerRow1");
let canvasPlayer2 = document.getElementById("canvasPlayer2");
const cardGap = 70;
let multiplierRow1 = -1;
let initialXRow1 = 150;

let dealerHandTotal = 0;
let clearRectFlag = false;

function drawDealerCard(){

    document.getElementById('drawCardBtnLower').style.visibility = 'hidden';
    drawCardBtnUpper.disabled = true;
    drawCardBtnUpper.disabled = true;
    newRoundBtn.disabled = false;

    let ctx1 = canvasDealer.getContext("2d");
    IsASplitFlag = false;
    
    clearRectFlag = true;
    alert("in dealer function");

    
   
   
   
    while (dealerHandTotal <= 17)
    {
        multiplierRow1++;
        let mark  = getMarkOfCard(52*5-1);

        if (mark == "Q" || mark == "K" || mark == "Q" || mark == "J" || mark == "10")
        {
            dealerHandTotal = dealerHandTotal + 10;
        }
        else if (mark == "A")
        {
            dealerHandTotal = dealerHandTotal + 1;
        }
        else
        {
            dealerHandTotal = dealerHandTotal + parseInt(mark);
        }
        console.log("dealerHandTotal", dealerHandTotal);

        ctx1.beginPath();
        ctx1.fillStyle='red';
        ctx1.rect((initialXRow1) +  multiplierRow1 * cardGap, 7 , 50, 64);
        ctx1.stroke();
        ctx1.font = "50px Arial";


        if(mark == "10"){
            ctx1.fillText(mark, initialXRow1 + multiplierRow1 * cardGap-4,  60 );
        }
        else{
            ctx1.fillText(mark, initialXRow1 + multiplierRow1 * cardGap+10,  60 );
        }


    }

    if (dealerHandTotal > 21)
    {
        //BUST
        pointsHave = pointsHave + (pointsWagered);
        let text = `DEALER BUSTS!  YOU WIN ${pointsWagered} POINTS - SCORE: ${pointsHave}`;
        document.getElementById("messageUpper").textContent = text;
    }
    
    else if (dealerHandTotal > playerScoreRow1)
    {
        //DEALER WINS
        pointsHave = pointsHave - (pointsWagered);
        let text = `DEALER WINS!  YOU LOSE ${pointsWagered} POINTS - SCORE: ${pointsHave}`;
        document.getElementById("messageUpper").textContent = text;
    
    }
    else 
    {
        //PLAYER WINS
        pointsHave = pointsHave + (pointsWagered);
        let text = `YOU WIN!  ${pointsWagered} POINTS - SCORE: ${pointsHave}`;
        document.getElementById("messageUpper").textContent = text;
    
    }

    //player
    counterAcesRow1 = -1;
    playerScoreRow1 = 0;
    multiplierRow1 = -1;
    initialXRow1 = 150;
    dealerHandTotal = 0;
    
    //?
    //multiplierRow2 = -1;
    

}




//variable for final row 3 (split deck)
let AreThereAcesArrayRow2 = ["no ace","no ace","no ace","no ace"]; 
let AreThereAcesArrayRow1 = ["no ace","no ace","no ace","no ace"]; 
let playerScoreRow1 = 0;
let pointsHave = 30;
let pointsWagered = 0;
//temporary for testing split
let globvar = 1;
//this can change - comment
let playerTotalPoints = 3;
let IsASplitFlag = false;
//uncertain
let turnNoReset = 0;
let  WasASplitFlag = false;
        
function drawPlayerCards1()
{

    

    turnNoReset++;
    numberOfIterationsRow2++;
    
    if( WasASplitFlag == true && numberOfIterationsRow2 > 3 && numberOfIterationsRow3 > 1)
    {
        
        dealCardBtndisabled = false;
        
    }
    else{
       
        dealCardBtndisabled = true;
    }
    console.log("1:",WasASplitFlag, numberOfIterationsRow2, numberOfIterationsRow3);

    document.getElementById('split').style.visibility = 'hidden';
    
   

   
    //let ctx1 = 
    let ctx2 = canvasPlayerRow1.getContext("2d");
   
    //two tens dealt, and chose to display two stacks of decks
   if (IsASplitFlag === true )
   {
    ctx2.clearRect(0,0,1000,78);
    currentCardsDeltRow2 = 0;
    multiplierRow2 = - 1;
    playerScoreRow2 = 0;
    IsASplitFlag = false;

   }
    

   
    if (clearRectFlag == true)
    {

        document.getElementById('messageLower').style.visibility = 'hidden';
        document.getElementById('canvasPlayer2').style.visibility = 'hidden';
        document.getElementById('drawCardBtnLower').style.visibility = 'hidden';
        document.getElementById('split').style.visibility = 'hidden';

        ctx1.clearRect(0,0,1000,78);
        ctx2.clearRect(0,0,1000,78);

        clearRectFlag = false;
    }
   
    multiplierRow2++;
    
    




    //for testing - SOME OF THIS IS NEEDED!!!!
    let mark = "";
    if(globvar == 1 || globvar == 2 || globvar == 3 )
    {
        mark = "10";
        globvar++;
       
    }
    else
    {
        mark  = getMarkOfCard((52*5)-1);
    }


    

    //ctx2 = canvasPlayer2.getContext("2d");
    ctx2.beginPath();
    ctx2.fillStyle='blue';
    ctx2.rect((initialXRow2) +  multiplierRow2 * cardGap, 7 , 50, 64);
    ctx2.stroke();
    ctx2.font = "50px Arial";
    
    if (mark == "Q" || mark == "K" || mark == "Q" || mark == "J" || mark == "10")
    {
        currentCardsDeltRow2++;
        playerScoreRow2 = playerScoreRow2 + 10;
    }
    else if (mark == "A")
    {
        currentCardsDeltRow2++;
        counterAcesRow2 = counterAcesRow2 + 1;
        playerScoreRow2 = playerScoreRow2 + 11;
        AreThereAcesArrayRow1[counterAcesRow2] = "is ace";
    }
    else
    {
        playerScoreRow2 = playerScoreRow2 + parseInt(mark);
        currentCardsDeltRow2++;
    }


    

    

    //two cards dealt and both are tens - not split yet
    if(currentCardsDeltRow2 == 2 && playerScoreRow2 == 20 && turnNoReset == 2)
    {
        
        dealCardBtndisabled = false;
        document.getElementById('split').style.visibility = 'visible';
        IsASplitFlag = false;
        WasASplitFlag = true;
        
        


    }


    if(playerScoreRow2 < 22 && currentCardsDeltRow2 == 5)
    {
        console.log("5 Card Charlie");
        pointsHave = pointsHave + (pointsWagered);

        playerTotalPoints = playerTotalPoints + pointsWagered;

        let text = `5 CARDS!  YOU WIN ${pointsWagered} POINTS`;
        let text2 = `Total Points: ${playerTotalPoints}.`;
        document.getElementById("messageUpper").textContent = text;
        document.getElementById("scoreUpper").textContent = text2;
    }
    
    else if (playerScoreRow2 > 21)
    {
        for(let i = 0 ; i < 4; i++)
        {
                if(AreThereAcesArrayRow1[i] == "is ace")
                {
                    AreThereAcesArrayRow1[i] == "used ace";
                    playerScoreRow2 = playerScoreRow2 - 10;
                    break;
                }
        }
    }

        if(playerScoreRow2 > 21)
        {
                    
                    pointsHave = pointsHave - pointsWagered;

                    playerTotalPoints = playerTotalPoints - pointsWagered;

                    let text = `BUST!  YOU LOSE ${pointsWagered} POINTS`;
                    document.getElementById("messageUpper").textContent = text;
                    document.getElementById("scoreUpper").textContent = playerTotalPoints; 
                    
                    console.log("BUST!");
                   
                    //drawCardBtnUpper.disabled = true;

        }
            
        
    
    
    
    else if(playerScoreRow2 == 21)
    {
        console.log("Blackjack");
        dealCardBtndisabled = true;
        pointsHave = pointsHave + (pointsWagered*2)

        playerTotalPoints = playerTotalPoints + pointsWagered * 2;

        let text = `BLACKJACK!  YOU WIN ${pointsWagered*2} POINTS`;
        document.getElementById("messageUpper").textContent = text;
        document.getElementById("scoreUpper").textContent = playerTotalPoints; 
    }

    console.log("PlayerScore2", playerScoreRow2);




    if(mark == "10"){
        ctx2.fillText(mark, initialXRow2 + multiplierRow2 * cardGap-4,  60 );
    }
    else{
        ctx2.fillText(mark, initialXRow2 + multiplierRow2 * cardGap+10,  60 );
    }

   

}

let multiplierRow2 = -1;
let initialXRow2 = 150;
let playerScoreRow2 = 0;
var counterAcesRow2 = -1;
let numberOfIterationsRow2 = 0;
let currentCardsDeltRow2 = 0;

let multiplierRow3 = -1;
let initialXRow3 = 150;
let playerScoreRow3 = 0;
let totalCardsDeltRow3 = 0;
let numberOfIterationsRow3 = 0;



function drawPlayerCards2(mark)
{

    let ctx3 = canvasPlayer2.getContext("2d");

    //document.getElementById('split').style.visibility = 'hidden';
    

//////////////////////////////////
//////////////////////////////////

numberOfIterationsRow3++;

if( WasASplitFlag == true && numberOfIterationsRow2 > 3 && numberOfIterationsRow3 > 1)
    {
        //document.getElementById('dealCard').style.visibility = 'visible';
        dealCardBtndisabled = true;
        
    }
    else{
        //document.getElementById('dealCard').style.visibility = 'hidden';
        dealCardBtndisabled = true;
    }

    console.log("2:",WasASplitFlag, numberOfIterationsRow2, numberOfIterationsRow3);


if(mark === 0){

    mark  = getMarkOfCard(52*5-1);
}

    

   
    

   
    //if (clearRectFlag == true)
    //{

        //messageLower.style.hidden = 'true';
        //canvasPlayer2.style.hidden = 'true';
        //drawCardBtnLower.style.hidden = 'true';
        //split.style.hidden = 'true';
        document.getElementById('messageLower').style.visibility = 'visible';
        document.getElementById('canvasPlayer2').style.visibility = 'visible';
        document.getElementById('drawCardBtnLower').style.visibility = 'visible';
        //document.getElementById('split').style.visibility = 'visible';




    //    ctx1.clearRect(0,0,1000,78);
    //    ctx.clearRect(0,0,1000,78);
    //    clearRectFlag = false;
    //}
   
    multiplierRow3++;
    
   

    ctx3 = canvasPlayer2.getContext("2d");
    ctx3.beginPath();
    ctx3.fillStyle='blue';
    ctx3.rect((initialXRow3) +  multiplierRow3 * cardGap, 7 , 50, 64);
    console.log("log:", (initialXRow3) +  multiplierRow3 * cardGap, multiplierRow3);
    ctx3.stroke();
    ctx3.font = "50px Arial";
    
    if (mark == "Q" || mark == "K" || mark == "Q" || mark == "J" || mark == "10")
    {
        totalCardsDeltRow3++;
        playerScoreRow3 = playerScoreRow3 + 10;
    }
    else if (mark == "A")
    {
        totalCardsDeltRow3++;
        counterAcesRow2 = counterAcesRow2 + 1;
        playerScoreRow3 = playerScoreRow3 + 11;
        AreThereAcesArrayRow2[counterAcesRow2] = "is ace";
    }
    else
    {
        playerScoreRow3 = playerScoreRow3 + parseInt(mark);
        totalCardsDeltRow3++;
    }

    if(totalCardsDeltRow3 == 2)
    {
        dealCardBtndisabled = false;
    }

    


    if(playerScoreRow3 < 22 && totalCardsDeltRow3 == 5)
    {
        console.log("5 Card Charlie");
        pointsHave = pointsHave + (pointsWagered);
        
        playerTotalPoints = playerTotalPoints + pointsWagered;

        let text = `5 CARDS!  YOU WIN ${pointsWagered}`;
        document.getElementById("messageLower").textContent = text;
        document.getElementById("scoreUpper").textContent = playerTotalPoints;
        document.getElementById('drawCardBtnLower').style.visibility = 'hidden';

    }
    
    else if (playerScoreRow3 > 21)
    {
        for(let i = 0 ; i < 4; i++)
        {
                if(AreThereAcesArrayRow2[i] == "is ace")
                {
                    AreThereAcesArrayRow2[i] == "used ace";
                    playerScoreRow3 = playerScoreRow3 - 10;
                    break;
                }
        }
    }

        if(playerScoreRow3 > 21)
        {
                    
                    pointsHave = pointsHave - pointsWagered;
                    playerTotalPoints = playerTotalPoints - pointsWagered;

                    let text = `BUST!  YOU LOSE ${pointsWagered}`;
                    document.getElementById("messageLower").textContent = text;
                    document.getElementById("scoreUpper").textContent = playerTotalPoints;
 
                    
                    console.log("BUST!");
                   
                    
                    
                    
                    if (!IsASplitFlag){
                    //drawCardBtnUpper.disabled = true;
                    }

                    document.getElementById('drawCardBtnLower').style.visibility = 'hidden';

        }
            
        
    
    
    
    else if(playerScoreRow3 == 21)
    {
        console.log("Blackjack");
        dealCardBtndisabled = true;
        pointsHave = pointsHave + (pointsWagered*2);

        playerTotalPoints = playerTotalPoints + pointsWagered*2;
        
        let text = `BLACKJACK!  YOU WIN ${pointsWagered*2}`;
        document.getElementById("messageLower").textContent = text;
        document.getElementById("scoreUpper").textContent = playerTotalPoints;
        document.getElementById('drawCardBtnLower').style.visibility = 'hidden';
 
    }

    console.log("PlayerScore", playerScoreRow3);




    if(mark == "10"){
        ctx3.fillText(mark, initialXRow3 + multiplierRow3 * cardGap-4,  60 );
    }
    else{
        ctx3.fillText(mark, initialXRow3 + multiplierRow3 * cardGap+10,  60 );
    }

///////////////////////////////////
///////////////////////////////////


}


function drawInitialCards()
{
    drawCardBtnUpper.disabled = true;
    dealCardBtndisabled = true;
    //document.getElementById('newRoundBtn').style.visibility = 'hidden';
    drawCardBtnUpper.disabled = true;
    
    //amtPlayerCards1++;
}


let deckUseage = 
[
0,0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,0,

0,0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,0,

0,0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,0,

0,0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,0,

0,0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,0


];

let decks = 
[
"A", "Q", "K", "J", "2", "3", "4", "5", "6", "7", "8", "9", "10",
"A", "Q", "K", "J", "2", "3", "4", "5", "6", "7", "8", "9", "10", 
"A", "Q", "K", "J", "2", "3", "4", "5", "6", "7", "8", "9", "10",
"A", "Q", "K", "J", "2", "3", "4", "5", "6", "7", "8", "9", "10",

"A", "Q", "K", "J", "2", "3", "4", "5", "6", "7", "8", "9", "10",
"A", "Q", "K", "J", "2", "3", "4", "5", "6", "7", "8", "9", "10", 
"A", "Q", "K", "J", "2", "3", "4", "5", "6", "7", "8", "9", "10",
"A", "Q", "K", "J", "2", "3", "4", "5", "6", "7", "8", "9", "10",

"A", "Q", "K", "J", "2", "3", "4", "5", "6", "7", "8", "9", "10",
"A", "Q", "K", "J", "2", "3", "4", "5", "6", "7", "8", "9", "10", 
"A", "Q", "K", "J", "2", "3", "4", "5", "6", "7", "8", "9", "10",
"A", "Q", "K", "J", "2", "3", "4", "5", "6", "7", "8", "9", "10",

"A", "Q", "K", "J", "2", "3", "4", "5", "6", "7", "8", "9", "10",
"A", "Q", "K", "J", "2", "3", "4", "5", "6", "7", "8", "9", "10", 
"A", "Q", "K", "J", "2", "3", "4", "5", "6", "7", "8", "9", "10",
"A", "Q", "K", "J", "2", "3", "4", "5", "6", "7", "8", "9", "10",

"A", "Q", "K", "J", "2", "3", "4", "5", "6", "7", "8", "9", "10",
"A", "Q", "K", "J", "2", "3", "4", "5", "6", "7", "8", "9", "10", 
"A", "Q", "K", "J", "2", "3", "4", "5", "6", "7", "8", "9", "10",
"A", "Q", "K", "J", "2", "3", "4", "5", "6", "7", "8", "9", "10"
];






//finds a card as long as at least one card remains
function getMarkOfCard()
{
    let flagFoundCard = false;
    let index = Math.floor((Math.random() * (52*5)));
    const card = decks[index];
    if(deckUseage[card] == 0)
    {
        deckUseage[card] = 1;
    }
    else
    {
        for(let i = card ; i >= 0; i-- )
        {
            if (card[i] == 0)
            {
                card[i] =  1;
                flagFounCard = true;
                break;
            }
            

        }
        if (flagFoundCard == false)
        {
            for(let i = card + 1 ; i < 54*4*5 ; i++)
            {
                if (card[i] = 0)
                {
                    card[i] = 1;
                    break;
                }
            }
        }
    }
    
return card;
}
 

function dealDealer(){

} 

function wager(points_Wagered){

if(points_Wagered > pointsHave)
{
    return(1);
}
pointsWagered =  points_Wagered;

drawCardBtnUpper.disabled = false;
wagerButtonOne.disabled=true;
wagerButtonFive.disabled=true;
wagerButtonFifteen.disabled=true;
wagerButtonTwentyfive.disabled=true;

}

function unhidePlayerRow2(){
   
    IsASplitFlag = true;
    document.getElementById('split').style.visibility = 'hidden';
    document.getElementById('canvasPlayer2').style.visibility = 'visible';
    document.getElementById('messageLower').style.visibility = 'visible';
    document.getElementById('drawCardBtnLower').style.visibility = 'visible';
    
    wasASplit = true;
    drawPlayerCards2(10);
    drawPlayerCards1();
    
}

function newRound(){



}
drawInitialCards();


document.getElementById("drawCardBtnUpper").addEventListener("click", drawPlayerCards1);
document.getElementById("dealCard").addEventListener("click", drawDealerCard);
document.getElementById("split").addEventListener("click", unhidePlayerRow2);
document.getElementById("newRoundBtn").addEventListener("click", newRound);



</script>

</body>










</script>
</html>